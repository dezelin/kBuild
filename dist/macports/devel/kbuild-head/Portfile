# $Id$
# Very crude atm, everything is exec'ed.

PortSystem 1.0
name            kbuild-head
version         9999
categories      devel
maintainers     bird-kBuild-spam@anduin.net
description     kBuild subversion trunk
long_description \
    See http://svn.netlabs.org/kbuild (I'm lazy).

homepage        http://svn.netlabs.org/kbuild
platforms       darwin
fetch.type      svn
#svn.url         http://svn.netlabs.org/repos/kbuild/trunk
svn.url         svn://system360/svn-mirrors/kbuild/trunk
worksrcdir   	trunk

test.run        no

configure {}

build {
    system "${workpath}/${worksrcdir}/kBuild/env.sh --release kmk -C ${workpath}/${worksrcdir} NIX_INSTALL_DIR=${prefix} -j ${buildmakejobs}"
}

test {
    system "${workpath}/${worksrcdir}/out/darwin.x86/release/kBuild/bin/darwin.x86/kmk -C ${workpath}/${worksrcdir}/tests nothing"
}

destroot {
    system "${workpath}/${worksrcdir}/kBuild/env.sh --release kmk -C ${workpath}/${worksrcdir} NIX_INSTALL_DIR=${prefix} PATH_INS=${destroot}/"
}

